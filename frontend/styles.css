:root{
  --bg:#0b1320;
  --bg2:#0a1020;
  --panel:#1f1f1f;
  --panel2:#232323;
  --card:#232323;
  --card2:rgba(40,40,40,.72);
  --text:#e8e8e8;
  --muted:rgba(232,232,232,.62);
  --line:rgba(255,255,255,.07);
  --line2:rgba(255,255,255,.10);
  --blue:#2f7bff;
  --blue2:#6aa3ff;
  --shadow:0 14px 40px rgba(0,0,0,.38);
  --radius:14px;
  --radius2:18px;
  --rail:#141414;
  --rail2:#101010;
  --rail-w:56px;
  --sidebar-w:320px;
}

/*
  Ensure the HTML [hidden] attribute always hides elements.
  Some component rules (e.g. .modal { display:flex }) can otherwise override
  the user-agent default and make hidden modals appear and block the UI.
*/
[hidden]{display:none !important;}
:root[data-theme="light"]{
  --bg:#eef1f6;
  --bg2:#e9eef8;
  --panel:#ffffff;
  --panel2:#f6f7fb;
  --card:#ffffff;
  --card2:rgba(255,255,255,.75);
  --text:#0f172a;
  --muted:rgba(15,23,42,.55);
  --line:rgba(15,23,42,.10);
  --line2:rgba(15,23,42,.14);
  --blue:#2563eb;
  --blue2:#1d4ed8;
  --shadow:0 18px 45px rgba(15,23,42,.12);
  --rail:#f1f5f9;
  --rail2:#e2e8f0;
}

*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:
  radial-gradient(1200px 720px at 50% -10%, rgba(80,140,255,.18), transparent 55%),
  radial-gradient(1200px 900px at 20% 120%, rgba(0,160,255,.12), transparent 55%),
  linear-gradient(180deg,var(--bg) 0%, var(--bg2) 100%);
  color:var(--text)}

.ico{width:18px;height:18px;display:inline-block;vertical-align:middle}
.ico.sm{width:16px;height:16px}
button,input,select,textarea{font:inherit}

/* Shell layout */
.app-shell{min-height:100vh;display:flex}

/* Left rail */
.rail{width:var(--rail-w);background:linear-gradient(180deg,var(--rail) 0%, var(--rail2) 100%);border-right:1px solid var(--line);display:none;flex-direction:column;align-items:center;padding:10px 8px;gap:10px;position:sticky;top:0;height:100vh}
.rail-avatar{width:36px;height:36px;border-radius:999px;border:1px solid var(--line2);background:rgba(255,255,255,.06);color:var(--text);cursor:pointer;display:flex;align-items:center;justify-content:center}
.rail-items{display:flex;flex-direction:column;gap:8px;margin-top:6px}
.rail-bottom{margin-top:auto;display:flex;flex-direction:column;gap:8px}
.rail-item{width:40px;height:40px;border-radius:12px;border:0;background:transparent;color:var(--muted);cursor:pointer;display:flex;align-items:center;justify-content:center}
.rail-item:hover{background:rgba(255,255,255,.06);color:var(--text)}
.rail-item.active{background:rgba(255,255,255,.10);color:var(--text)}
.ri-ico{font-size:18px;font-weight:800;line-height:1}

/* Sidebar */
.drawer-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.55);z-index:40}
.drawer.sidebar{width:min(var(--sidebar-w),86vw);background:linear-gradient(180deg,rgba(18,26,40,.92) 0%, rgba(16,22,34,.92) 100%);border-right:1px solid rgba(255,255,255,.07);color:var(--text);z-index:41;position:fixed;top:0;left:0;height:100vh;padding:10px 10px 12px;backdrop-filter:blur(18px)}
.sidebar-inner{height:100%;display:flex;flex-direction:column}
.drawer-nav{display:flex;flex-direction:column;gap:4px;padding:4px}
.drawer-sep{height:1px;background:var(--line);margin:8px 6px}
.drawer-section-title{font-size:12px;letter-spacing:.5px;color:rgba(232,232,232,.42);font-weight:800;padding:2px 8px}
.drawer-item{width:100%;display:flex;align-items:center;gap:10px;padding:10px 10px;border-radius:12px;border:0;background:transparent;color:var(--text);cursor:pointer;font-weight:700;text-align:left}
.drawer-item:hover{background:rgba(255,255,255,.06)}
.drawer-item.active{background:rgba(255,255,255,.10)}

.drawer-group{margin-top:4px}
.folder-head{width:100%;display:flex;align-items:center;gap:10px;padding:10px 10px;border-radius:12px;border:1px solid var(--line);background:rgba(255,255,255,.03);color:var(--text);cursor:pointer;font-weight:800;text-align:left}
.folder-head:hover{background:rgba(255,255,255,.06)}
.folder-head .fh-title{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.folder-head .fh-count{color:rgba(232,232,232,.58);font-weight:900}
.folder-head .fh-chevron{color:rgba(232,232,232,.45);font-weight:900}
.folder-lists{margin-left:6px;margin-top:4px;display:flex;flex-direction:column;gap:2px}
.di-more{border:0;background:transparent;color:rgba(232,232,232,.70);cursor:pointer;font-size:18px;line-height:1;padding:6px 8px;border-radius:10px}
.di-more:hover{background:rgba(255,255,255,.08);color:var(--text)}
.drawer-item.ghost{opacity:.92}
.di-emoji{width:20px;text-align:center;opacity:.9}
.di-title{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.di-count{color:rgba(232,232,232,.58);font-weight:800}
.drawer-add{width:100%;border:1px solid var(--line);background:rgba(255,255,255,.06);color:var(--text);font-weight:800;padding:12px;border-radius:14px;cursor:pointer}
.drawer-bottom{margin-top:auto;padding:6px}

.hint-card{margin:6px 6px 0;padding:10px 12px;border:1px solid var(--line);border-radius:12px;background:rgba(255,255,255,.04);color:rgba(232,232,232,.50);font-size:12px;line-height:1.35}

/* Main */
.main{flex:1;min-width:0;display:flex}
.container{flex:1;min-width:0;padding:14px 14px 200px}

/* Topbar */
.topbar{height:56px;display:flex;align-items:center;justify-content:space-between;padding:0 12px;border-bottom:1px solid var(--line);background:rgba(0,0,0,.12);backdrop-filter:blur(14px);position:sticky;top:0;z-index:20}
.tb-left{display:flex;align-items:center;gap:10px;min-width:0}
.tb-title{min-width:0}
.title-main{font-weight:900;font-size:20px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.icon-btn{width:40px;height:40px;border-radius:12px;border:1px solid var(--line);background:rgba(255,255,255,.04);color:var(--text);cursor:pointer}
.icon-btn:hover{background:rgba(255,255,255,.07)}
.tb-only-mobile{display:inline-flex}

/* Calendar bar */
.calbar{display:flex;align-items:center;gap:14px}
.cal-title{font-weight:900;font-size:20px;text-transform:lowercase}
.cal-actions{display:flex;align-items:center;gap:8px}
.cal-btn{height:34px;border-radius:10px;border:1px solid var(--line);background:rgba(255,255,255,.04);color:var(--text);padding:0 10px;cursor:pointer;font-weight:800}
.cal-btn:hover{background:rgba(255,255,255,.07)}

/* Views */
.view{display:none}
.view.view-active{display:block}

/* Search */
.search{display:flex;align-items:center;gap:10px;padding:12px 14px;border-radius:999px;background:rgba(255,255,255,.04);border:1px solid var(--line);margin-top:12px}
.search.big{padding:14px 16px}
.search input{border:0;outline:none;background:transparent;width:100%;font-size:16px;color:var(--text)}
.search-ico{color:var(--muted);font-weight:900}

/* Desktop add bar */
.desk-addbar{position:relative;display:none;align-items:center;gap:10px;padding:11px 14px;border-radius:12px;background:rgba(255,255,255,.04);border:1px solid var(--line);margin-top:12px}
.desk-addbar:focus-within{border-color:rgba(47,123,255,.55);box-shadow:0 0 0 2px rgba(47,123,255,.18)}
.dab-plus{opacity:.65;font-weight:900}
.desk-addbar input{flex:1;border:0;outline:none;background:transparent;color:var(--text);font-size:14px}
.dab-icon{height:30px;min-width:30px;border-radius:10px;border:1px solid var(--line);background:rgba(255,255,255,.04);color:var(--muted);cursor:pointer;display:inline-flex;align-items:center;justify-content:center;padding:0 8px}
.dab-icon:hover{color:var(--text)}
.dab-date{position:absolute;left:-9999px;opacity:0;pointer-events:none}
.dab-btn{height:30px;border-radius:10px;border:1px solid var(--line);background:rgba(255,255,255,.04);color:var(--muted);cursor:pointer;padding:0 10px}
.dab-btn:hover{color:var(--text)}

/* Tasks split layout (TickTick-like editor) */
.tasks-layout{display:block}
.tasks-pane{min-width:0}

.pane-head{display:none;align-items:center;justify-content:space-between;margin-top:6px;padding:0 4px}
.ph-left{display:flex;align-items:baseline;gap:10px;min-width:0}
.ph-title{font-weight:950;font-size:18px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.ph-count{font-weight:950;font-size:18px;color:rgba(232,232,232,.55)}
:root[data-theme="light"] .ph-count{color:rgba(15,23,42,.45)}
.ph-right{display:flex;align-items:center;gap:8px}
.icon-btn.icon-btn-sm{width:34px;height:34px;border-radius:12px;font-weight:900}
.pane-sub{display:none;margin-top:10px;padding:0 4px}
.link-btn{border:0;background:transparent;color:var(--blue2);cursor:pointer;font-weight:900;padding:6px 0}
.link-btn:hover{text-decoration:underline}

@media (min-width: 900px){
  .tasks-layout{display:flex;align-items:flex-start;gap:18px}
  .tasks-pane{width:520px;max-width:520px}
  .pane-head{display:flex}
  .pane-sub{display:block}
}

/* Default (no split) list look: flat rows */
#tasksLayout:not(.split) .tasks{gap:0}
#tasksLayout:not(.split) .task{border-radius:0}
#tasksLayout:not(.split) .task-card{background:transparent;border:0;border-bottom:1px solid var(--line);border-radius:0;padding:12px 8px}
#tasksLayout:not(.split) .task-card:hover{background:rgba(255,255,255,.03)}
#tasksLayout:not(.split) .task:last-child .task-card{border-bottom:0}
#tasksLayout:not(.split) .task-actions{opacity:0;pointer-events:none}
#tasksLayout:not(.split) .task:hover .task-actions{opacity:1;pointer-events:auto}
#tasksLayout:not(.split) .task.selected .task-card{background:rgba(47,123,255,.10)}

/* Split mode list look: cards */
#tasksLayout.split .tasks{gap:10px}
#tasksLayout.split .task{border-radius:var(--radius)}
#tasksLayout.split .task-card{background:rgba(255,255,255,.04);border:1px solid var(--line);border-radius:var(--radius);padding:14px}
#tasksLayout.split .task.selected .task-card{border-color:rgba(47,123,255,.55);box-shadow:0 0 0 1px rgba(47,123,255,.25) inset}

/* Editor panel */
.task-editor{display:none;min-width:0;flex:1;border:1px solid var(--line);border-radius:18px;background:rgba(0,0,0,.12);backdrop-filter:blur(14px);box-shadow:var(--shadow)}
@media (min-width: 900px){
  .task-editor{display:block;position:sticky;top:72px;height:calc(100vh - 110px)}
}
.task-editor[hidden]{display:none !important}
.te-head{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid var(--line)}
.te-head-left{display:flex;align-items:center;gap:10px}
.te-check{width:30px;height:30px;border-radius:10px;border:1px solid var(--line2);background:rgba(255,255,255,.03);cursor:pointer;display:flex;align-items:center;justify-content:center;color:var(--muted)}
.te-check.done{border-color:rgba(47,123,255,.55);background:rgba(47,123,255,.14);color:var(--blue)}
.te-check.done::after{content:"✓";font-weight:900}
.te-date{display:flex;align-items:center;gap:8px;border:1px solid var(--line);background:rgba(255,255,255,.03);color:var(--text);border-radius:12px;padding:8px 10px;cursor:pointer;font-weight:900}
.te-date span{opacity:.95}
.te-body{padding:14px 14px 8px;display:flex;flex-direction:column;gap:10px;height:calc(100% - 110px);overflow:auto}
.te-title{border:0;outline:none;background:transparent;color:var(--text);font-weight:950;font-size:22px;line-height:1.2}
.te-notes{border:0;outline:none;background:transparent;color:rgba(232,232,232,.75);font-size:14px;line-height:1.5;min-height:220px;resize:none}
:root[data-theme="light"] .te-notes{color:rgba(15,23,42,.65)}
.te-foot{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-top:1px solid var(--line)}
.te-pill{display:flex;align-items:center;gap:8px;border:1px solid var(--line);background:rgba(255,255,255,.03);color:var(--text);border-radius:14px;padding:10px 12px;cursor:pointer;font-weight:900;max-width:65%}
.te-pill span{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.te-actions{display:flex;align-items:center;gap:8px}
.te-date-input{position:absolute;opacity:0;pointer-events:none}

/* Task list */
.section-head{margin-top:18px;width:100%;border:0;background:transparent;color:rgba(232,232,232,.65);font-weight:900;font-size:14px;cursor:pointer;text-align:left;display:flex;align-items:center;gap:8px}
.section-head.muted{opacity:.92}

/* Sections (TickTick-like) */
.sec-head{margin-top:14px;padding:8px 8px;display:flex;align-items:center;gap:8px;border-radius:10px;background:rgba(255,255,255,.02);border:1px solid rgba(255,255,255,.06)}
.sec-toggle{width:28px;height:28px;border-radius:8px;border:0;background:rgba(255,255,255,.04);color:rgba(232,232,232,.8);cursor:pointer}
.sec-title{flex:1;font-weight:800;color:rgba(232,232,232,.92);text-transform:lowercase}
.sec-count{font-weight:700;color:rgba(232,232,232,.55)}
.sec-actions{display:flex;align-items:center;gap:6px}
[data-theme="light"] .sec-head{background:rgba(0,0,0,.02);border-color:rgba(0,0,0,.06)}
[data-theme="light"] .sec-toggle{background:rgba(0,0,0,.04);color:rgba(10,10,10,.7)}
[data-theme="light"] .sec-title{color:rgba(10,10,10,.9)}
[data-theme="light"] .sec-count{color:rgba(10,10,10,.5)}


.tasks{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:10px}
.task{position:relative;overflow:hidden;border-radius:var(--radius)}
.task.completed{opacity:.75}
.task.completed .task-title{opacity:.6;text-decoration:line-through}

/* Swipe (mobile) */
.swipe-actions{position:absolute;inset:0;display:flex;align-items:center;justify-content:space-between;padding:0 10px}
.action-btn{border:0;cursor:pointer;font-weight:900;color:white;border-radius:12px;padding:12px 14px}
.action-btn.complete{background:rgba(34,197,94,.95)}
.action-btn.delete{background:rgba(239,68,68,.95)}

.task-card{display:flex;align-items:center;gap:12px;padding:14px 14px;background:rgba(255,255,255,.04);border:1px solid var(--line);border-radius:var(--radius);transform:translateX(0);transition:transform 160ms ease;touch-action:pan-y}
.task.dragging .task-card{opacity:.85}

.checkbox{width:18px;height:18px;border-radius:5px;border:1px solid rgba(232,232,232,.35);display:flex;align-items:center;justify-content:center;cursor:pointer;flex:0 0 auto}
.checkbox.checked{border-color:rgba(47,123,255,.85);background:rgba(47,123,255,.14)}
.checkbox.checked::after{content:"✓";font-weight:900;color:var(--blue);font-size:13px}
.task-main{flex:1;min-width:0}
.task-title{font-size:15px;font-weight:800;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:flex;gap:8px;align-items:center}
.flag{font-size:12px;padding:2px 6px;border-radius:999px;background:rgba(239,68,68,.14);color:rgba(239,68,68,.95);font-weight:900}
.task-meta{margin-top:6px;font-size:12px;color:var(--muted);font-weight:800;display:flex;gap:8px;flex-wrap:wrap}
.due{color:var(--blue2);font-weight:900;min-width:70px;text-align:right}
.due .rm-list{color:rgba(232,232,232,.55);font-weight:800}
.due .rm-due{color:var(--blue2);font-weight:900}

.task-actions{display:flex;gap:8px}
.small-btn{border:0;background:rgba(255,255,255,.06);color:var(--text);border-radius:12px;padding:10px;cursor:pointer;font-weight:900}

.chipTag{padding:2px 8px;border-radius:999px;background:rgba(47,123,255,.12);color:var(--blue2);font-weight:900}

.empty{margin-top:14px;padding:18px;text-align:center;color:var(--muted);font-weight:800}

/* Calendar */
.calendar{margin-top:12px;border:1px solid var(--line);border-radius:14px;overflow:hidden;background:rgba(255,255,255,.02)}
.cal-head{display:grid;grid-template-columns:repeat(7,1fr);border-bottom:1px solid var(--line)}
.cal-week{padding:8px 10px;color:rgba(232,232,232,.55);font-weight:900;font-size:12px}
.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);grid-auto-rows:118px}
.cal-cell{border-right:1px solid var(--line);border-bottom:1px solid var(--line);padding:8px 8px 6px;position:relative;overflow:hidden}
.cal-cell:nth-child(7n){border-right:0}
.cal-day{font-weight:900;font-size:13px;opacity:.92}
.cal-day.muted{opacity:.35}
.cal-events{margin-top:6px;display:flex;flex-direction:column;gap:4px}
.cal-event{height:18px;border-radius:4px;display:flex;align-items:center;gap:6px;padding:0 6px;font-size:12px;font-weight:800;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;border-left:3px solid rgba(255,255,255,.8);background:rgba(255,255,255,.06)}
.cal-event .time{opacity:.7;font-weight:900}
.cal-more{margin-top:2px;color:rgba(232,232,232,.55);font-size:12px;font-weight:800}

/* Summary */
.summary{margin-top:10px;display:flex}
.summary-editor{flex:1;min-width:0}
.editor-toolbar{display:flex;align-items:center;gap:8px;padding:10px 10px;border:1px solid var(--line);border-bottom:0;border-top-left-radius:14px;border-top-right-radius:14px;background:rgba(255,255,255,.03)}
.tbbtn{height:28px;min-width:28px;border-radius:8px;border:1px solid var(--line);background:rgba(255,255,255,.03);color:var(--text);cursor:pointer;font-weight:900;padding:0 8px}
.tbbtn:hover{background:rgba(255,255,255,.06)}
.tbsp{flex:1}
.editor-wrap{border:1px solid var(--line);border-bottom-left-radius:14px;border-bottom-right-radius:14px;background:rgba(0,0,0,.10);height:calc(100vh - 170px);min-height:420px;overflow:auto}
.editor{padding:18px 16px;outline:none;font-size:14px;line-height:1.55}
.editor h2{margin:0 0 10px;font-size:18px}
.editor ul{padding-left:18px}
.editor a{color:var(--blue2)}
.summary-actions{display:flex;justify-content:flex-end;gap:14px;padding:10px 6px}
.link{border:0;background:transparent;color:rgba(232,232,232,.75);cursor:pointer;font-weight:800}
.link:hover{color:var(--text)}

/* Right panel */
.rightpanel{width:320px;border-left:1px solid var(--line);background:rgba(0,0,0,.10);padding:12px 12px 18px;display:none;flex-direction:column;gap:12px}
.rp-block{border:1px solid var(--line);border-radius:14px;background:rgba(255,255,255,.03);padding:10px 10px}
.rp-title{font-weight:900;color:rgba(232,232,232,.70);margin-bottom:8px}
.rp-plus{width:32px;height:32px;border-radius:10px;border:1px solid var(--line);background:rgba(255,255,255,.03);color:var(--text);cursor:pointer}
.rp-row{display:flex;align-items:center;justify-content:space-between;padding:10px 6px;border-top:1px solid var(--line)}
.rp-row:first-child{border-top:0}
.rp-val{color:rgba(232,232,232,.60);font-weight:800}
.toggle{width:46px;height:22px;border-radius:999px;border:1px solid var(--line);background:rgba(255,255,255,.04);position:relative;display:inline-block}
.toggle .knob{position:absolute;top:2px;left:2px;width:18px;height:18px;border-radius:999px;background:rgba(255,255,255,.55)}

/* Mobile composer/nav */
.composer{position:fixed;left:50%;transform:translateX(-50%);bottom:86px;width:min(520px, calc(100% - 28px));background:rgba(0,0,0,.25);backdrop-filter:blur(16px);border:1px solid var(--line);border-radius:999px;box-shadow:var(--shadow);display:flex;align-items:center;gap:10px;padding:10px 12px;z-index:30}
.comp-input{flex:1;border:0;outline:none;background:transparent;font-size:16px;font-weight:800;color:var(--text)}
.comp-btn{width:44px;height:44px;border-radius:999px;border:1px solid var(--line);cursor:pointer;background:rgba(255,255,255,.03);color:var(--text);font-size:18px}
.comp-btn.primary{background:rgba(47,123,255,.90);border-color:rgba(47,123,255,.70);color:white}
.comp-date{position:absolute;opacity:0;pointer-events:none}

.bottom-nav{position:fixed;left:50%;transform:translateX(-50%);bottom:18px;width:min(520px, calc(100% - 28px));background:rgba(0,0,0,.25);backdrop-filter:blur(16px);border:1px solid var(--line);border-radius:999px;box-shadow:var(--shadow);display:flex;justify-content:space-around;padding:10px 12px;z-index:29}
.bn-item{width:54px;height:44px;border:0;background:transparent;border-radius:999px;cursor:pointer;font-size:20px;color:var(--text)}
.bn-item.active{background:rgba(47,123,255,.18)}

/* Sheets (existing) */
.sheet-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.55);z-index:60}
.sheet{position:fixed;left:0;right:0;bottom:0;z-index:61;background:var(--panel);border-top-left-radius:22px;border-top-right-radius:22px;box-shadow:var(--shadow);padding:14px;border-top:1px solid var(--line)}
.sheet-title{max-width:520px;margin:0 auto 10px;font-weight:900;color:var(--text)}
.sheet-option{max-width:520px;margin:0 auto 10px;width:100%;border:1px solid var(--line);background:rgba(255,255,255,.04);color:var(--text);padding:14px;border-radius:16px;cursor:pointer;font-weight:900;text-align:left}
.sheet-option.ghost{background:transparent}
.sheet-form{max-width:520px;margin:0 auto;display:flex;flex-direction:column;gap:12px}
.sheet-form input[type="text"], .sheet-form select{width:100%;padding:14px;border-radius:16px;border:1px solid var(--line);font-size:16px;outline:none;background:rgba(255,255,255,.03);color:var(--text)}
.sheet-form textarea{width:100%;padding:14px;border-radius:16px;border:1px solid var(--line);font-size:15px;outline:none;background:rgba(255,255,255,.03);color:var(--text);min-height:92px;resize:vertical}
.sheet-date{width:100%;padding:14px;border-radius:16px;border:1px solid var(--line);font-size:16px;outline:none;background:rgba(255,255,255,.03);color:var(--text)}
.sheet-textarea{min-height:110px}
.prio{display:flex;gap:10px;flex-wrap:wrap}
.prio-btn{border:1px solid var(--line);background:rgba(255,255,255,.04);color:var(--text);padding:10px 12px;border-radius:14px;cursor:pointer;font-weight:900;min-width:52px;text-align:center}
.prio-btn.active{background:rgba(47,123,255,.18);border-color:rgba(47,123,255,.35)}
.sheet-emoji{width:90px !important;text-align:center;font-size:18px !important}
.sheet-row{display:flex;align-items:center;gap:10px}
.sheet-label{color:var(--muted);font-weight:900;min-width:80px}
.sheet-select{flex:1}
.sheet-actions{display:flex;justify-content:flex-end;gap:10px;flex-wrap:wrap}
.btn{padding:12px 14px;border-radius:14px;border:1px solid var(--line);cursor:pointer;font-weight:900;background:rgba(255,255,255,.04);color:var(--text)}
.btn.primary{background:rgba(47,123,255,.90);border-color:rgba(47,123,255,.65);color:white}
.btn.ghost{background:rgba(255,255,255,.03)}
.pick-list{max-width:520px;margin:0 auto}

/* Menu */
.menu{position:fixed;left:62px;top:16px;z-index:80;min-width:180px;border-radius:14px;background:rgba(30,30,30,.98);border:1px solid var(--line);box-shadow:var(--shadow);padding:8px}
.menu-item{width:100%;border:0;background:transparent;color:var(--text);text-align:left;padding:10px 10px;border-radius:10px;cursor:pointer;font-weight:800}
.menu-item .ico{margin-right:8px;opacity:.9}
.menu-item:hover{background:rgba(255,255,255,.06)}
.menu-sep{height:1px;background:var(--line);margin:6px 4px}

/* Modal */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.55);z-index:90}
.modal{position:fixed;inset:6vh 6vw;z-index:91;border:1px solid var(--line);border-radius:18px;background:rgba(28,28,28,.98);box-shadow:var(--shadow);display:flex;flex-direction:column;overflow:hidden}
.modal-head{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid var(--line)}
.modal-title{font-weight:900;font-size:18px}
.modal-close{width:36px;height:36px;border-radius:12px;border:1px solid var(--line);background:rgba(255,255,255,.03);color:var(--text);cursor:pointer;font-size:20px;line-height:1}
.modal-body{display:grid;grid-template-columns:260px 1fr;min-height:0;flex:1}
.modal-nav{border-right:1px solid var(--line);padding:12px;overflow:auto}
.mnav-item{width:100%;text-align:left;border:0;background:transparent;color:rgba(232,232,232,.85);padding:10px 10px;border-radius:12px;cursor:pointer;font-weight:800}
.mnav-item.active{background:rgba(255,255,255,.08)}
.mnav-item:hover{background:rgba(255,255,255,.06)}
.mnav-sep{height:1px;background:var(--line);margin:10px 6px}
.modal-content{padding:16px 18px;overflow:auto}
.acc-head{display:flex;align-items:center;justify-content:center;flex-direction:column;gap:10px;padding:12px 0}
.acc-avatar{width:72px;height:72px;border-radius:999px;background:rgba(255,255,255,.06);display:flex;align-items:center;justify-content:center;font-size:30px}
.acc-note{color:rgba(232,232,232,.45);font-weight:800;text-align:center}
.accent{color:#ffb100;font-weight:900}
.card{border:1px solid var(--line);background:rgba(255,255,255,.03);border-radius:14px;padding:10px 12px;margin-top:12px}
.row{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:10px 6px;border-top:1px solid var(--line)}
.row:first-child{border-top:0}
.muted{color:rgba(232,232,232,.55);font-weight:800}
.danger{color:#ff4d4d;font-weight:900}

/* Responsive */
.mobile-only{display:block}

@media (min-width: 900px){
  .rail{display:flex}
  .drawer.sidebar{position:sticky;top:0;left:auto;height:100vh;display:block;z-index:10}
  .drawer-backdrop{display:none !important}
  .main{display:flex}
  .container{padding:14px 18px 140px}
  .tb-only-mobile{display:none}
  .desk-addbar{display:flex}
  .mobile-only{display:none}
  .bottom-nav{display:none}

  /* Desktop composer (like TickTick bottom bar) */
  .composer{display:flex;left:calc(var(--rail-w) + var(--sidebar-w) + 18px);transform:none;bottom:22px;width:calc(100% - var(--rail-w) - var(--sidebar-w) - 36px);max-width:980px;border-radius:18px;padding:10px 12px}

  /* Desktop task tweaks */
  .swipe-actions{display:none}
  .task-card{touch-action:auto}
  .checkbox{width:16px;height:16px;border-radius:4px}
  .task-title{font-size:14px;font-weight:800}
  .task-meta{display:none}
  .due{min-width:120px;font-size:12px}
  .due::after{content:""}

  /* Summary right panel */
  .main{gap:0}
  .rightpanel{display:flex}
  #rightPanel[hidden]{display:none}
}

/* Hide sidebar for calendar/search modules on desktop */
body[data-module="calendar"] .drawer.sidebar{display:none}
body[data-module="calendar"] .container{padding-left:18px}
body[data-module="calendar"] .tb-right{display:none}
body[data-module="calendar"] #calbar{display:flex !important}
body[data-module="calendar"] #viewCalendar{display:block}

body[data-module="search"] .drawer.sidebar{display:none}
body[data-module="search"] .tb-right{display:none}

/* Safe areas */
.composer{padding-bottom:calc(10px + env(safe-area-inset-bottom))}
.bottom-nav{bottom:calc(18px + env(safe-area-inset-bottom))}

/* Welcome / Auth */
.welcome{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:200;
  background:radial-gradient(900px 520px at 50% 0%, rgba(80,140,255,.18), transparent 60%),
  rgba(0,0,0,.74);
  backdrop-filter:blur(18px)
}

.welcome-home{width:min(520px, calc(100% - 28px));border-radius:18px;border:1px solid rgba(255,255,255,.10);
  background:rgba(10,14,22,.82);box-shadow:var(--shadow);padding:22px 18px 18px;text-align:center}
.welcome-brand{font-weight:950;font-size:28px;letter-spacing:.3px}
.welcome-sub{margin-top:6px;color:rgba(232,232,232,.72);font-weight:700}
.welcome-actions{margin-top:18px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
.welcome-btn{min-width:170px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.06);
  color:var(--text);font-weight:900;border-radius:14px;padding:12px 14px;cursor:pointer}
.welcome-btn.primary{border-color:rgba(47,123,255,.55);background:rgba(47,123,255,.92);color:white}

.auth-card{width:min(520px, calc(100% - 28px));border-radius:18px;border:1px solid rgba(255,255,255,.10);
  background:rgba(10,14,22,.82);box-shadow:var(--shadow);padding:18px 18px 16px}
.auth-head{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:14px}
.auth-back{border:none;background:rgba(255,255,255,.06);color:var(--text);border-radius:12px;padding:8px 10px;cursor:pointer;font-weight:900}
.auth-brand{font-weight:900;font-size:18px;letter-spacing:.2px}
.auth-top{border:1px solid rgba(47,123,255,.35);background:rgba(47,123,255,.16);color:var(--text);font-weight:900;border-radius:12px;padding:8px 12px;cursor:pointer}
.auth-top:hover{background:rgba(47,123,255,.22)}
.auth-tabs{display:flex;gap:8px}
.auth-tab{border:1px solid rgba(255,255,255,.10);background:rgba(255,255,255,.04);color:var(--text);font-weight:900;border-radius:12px;padding:8px 12px;cursor:pointer}
.auth-tab.active{background:rgba(47,123,255,.18);border-color:rgba(47,123,255,.35)}
.auth-form{display:flex;flex-direction:column;gap:10px}
.auth-label{font-size:12px;font-weight:900;color:rgba(232,232,232,.68)}
.auth-input{width:100%;padding:12px 14px;border-radius:14px;border:1px solid rgba(255,255,255,.10);background:rgba(255,255,255,.04);color:var(--text);outline:none}
.auth-input:focus{border-color:rgba(47,123,255,.55)}
.auth-btn{margin-top:6px;width:100%;padding:12px 14px;border-radius:14px;border:1px solid rgba(47,123,255,.55);
  background:rgba(47,123,255,.92);color:white;font-weight:900;cursor:pointer}
.auth-error{padding:10px 12px;border-radius:12px;border:1px solid rgba(239,68,68,.35);background:rgba(239,68,68,.10);color:rgba(255,200,200,.95);font-weight:800}
.auth-alt{margin-top:6px;font-size:13px;color:rgba(232,232,232,.70)}
.auth-link{border:none;background:transparent;color:rgba(47,123,255,.95);font-weight:900;cursor:pointer;padding:0}
.auth-link:hover{text-decoration:underline}


.sec-dragging{opacity:.65;filter:saturate(.8)}
